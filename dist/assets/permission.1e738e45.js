import{n as T,g as z,h as H}from"./element-plus.c3fec1c4.js";import{h as B,r as k,f as J}from"./index.18d78123.js";import{u as L}from"./useRole.7f901edb.js";import{d as E,k as M,bl as w,o,c as r,b as d,u as n,R as _,ae as f,H as O,I as x,a as i,Q as l,J as Q,a6 as U,P as C}from"./@vue.93d749de.js";import{_ as j}from"./tab.vue_vue_type_script_setup_true_lang.906c5d6d.js";import{_ as G}from"./_plugin-vue_export-helper.cdc0426e.js";import"./dayjs.192a6d29.js";import"./@kangc.828c9793.js";import"./vue.2f2618c0.js";import"./@vueuse.3a1db1c8.js";import"./@element-plus.4cdb3580.js";import"./lodash-es.dd6a6848.js";import"./async-validator.6019f6c6.js";import"./@sxzz.69bffcbd.js";import"./escape-html.ee221422.js";import"./normalize-wheel-es.25faf228.js";import"./@ctrl.46158b0f.js";import"./vue-router.9aaff3ab.js";import"./@icon-park.b1f4f028.js";import"./pinia.6fe13256.js";import"./vue-demi.f95da513.js";import"./axios.44703c6e.js";/* empty css                    */import"./prismjs.5c7695b9.js";import"./vee-validate.f34e48f3.js";import"./@vee-validate.51eabfa0.js";import"./yup.b2caa524.js";import"./nanoclone.76ad5e25.js";import"./lodash.393e310d.js";import"./property-expr.8748984a.js";import"./toposort.a92fde4e.js";import"./tab.2f0b0894.js";function K(e,t,s){return B.request({url:`site/${e}/role/${t}/permission`,method:"POST",data:{permissions:s}})}const W=()=>{const e=k.currentRoute.value.query.sid;return{sid:e,update:async(s,m)=>{await K(e,s,m)}}};function X(e){return B.request({url:`site/${e}/permission`})}const Y=()=>{const e=E(),t=k.currentRoute.value.query.sid;return{sid:t,permissions:e,getPermission:async()=>{e.value=await X(t)}}},Z={class:"text-base"},tt={class:"w-full"},et={class:"text-gray-600 text-sm font-bold pb-1"},st={class:"grid md:grid-cols-3 lg:grid-cols-6 grid-cols-1 text-sm text-gray-600 mb-3"},ot={class:"flex items-center"},rt={class:"text-xs flex items-center mb-1"},it=["value"],nt={class:"text-xs text-gray-500"},at=C("\u4FDD\u5B58\u63D0\u4EA4"),lt=M({__name:"permission",async setup(e){var y,g;let t,s;const{site:m,currentSite:S}=J(),{role:h,current:$,id:D}=L(),{update:R}=W(),{getPermission:q,permissions:V}=Y();[t,s]=w(async()=>Promise.all([([t,s]=w(()=>S()),t=await t,s(),t),$(),q()])),await t,s();const c=E((g=(y=h.value)==null?void 0:y.permissions.map(v=>v.name))!=null?g:[]);return(v,a)=>{var b;const A=T,F=z,N=H;return o(),r("div",null,[d(j,{site:n(m)},null,8,["site"]),d(A,{title:`\u3010${(b=n(h))==null?void 0:b.name}\u3011\u6743\u9650\u8BBE\u7F6E`,type:"success","show-icon":"",effect:"light"},null,8,["title"]),(o(!0),r(_,null,f(n(V).data,u=>(o(),O(F,{shadow:"hover","body-style":{padding:"20px"},class:"mb-3"},{header:x(()=>[i("h6",Z,l(u.title),1)]),default:x(()=>[(o(!0),r(_,null,f(u.permission,P=>(o(),r("dl",tt,[i("dt",et,l(P.title),1),i("dd",st,[(o(!0),r(_,null,f(P.items,p=>(o(),r("div",ot,[i("label",rt,[Q(i("input",{type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=I=>c.value=I),value:p.name,class:"mr-1"},null,8,it),[[U,c.value]]),C(" "+l(p.title)+" ",1),i("span",nt,l(p.name),1)])]))),256))])]))),256))]),_:2},1024))),256)),d(N,{type:"primary",size:"default",onClick:a[1]||(a[1]=u=>n(R)(n(D),c.value))},{default:x(()=>[at]),_:1})])}}});const Jt=G(lt,[["__scopeId","data-v-cc14e871"]]);export{Jt as default};
