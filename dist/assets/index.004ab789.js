import{h as T,H as L,y as R,o as O}from"./element-plus.c3fec1c4.js";import{m as G,_ as Q}from"./table.73947efa.js";import{u as U}from"./useModule.a495dc53.js";import{k as q,bl as H,d as N,o as u,c as d,b as _,I as l,u as o,C as z,P as r,H as f,O as h,R as A,ae as J,a as w,Q as K}from"./@vue.93d749de.js";import{_ as P}from"./_plugin-vue_export-helper.cdc0426e.js";import{_ as W}from"./tab.2f0b0894.js";import{h as F,r as X,f as Y,c as V,d as Z}from"./index.18d78123.js";import{u as ee}from"./@icon-park.b1f4f028.js";import"./dayjs.192a6d29.js";import"./@kangc.828c9793.js";import"./vue.2f2618c0.js";import"./@vueuse.3a1db1c8.js";import"./@element-plus.4cdb3580.js";import"./lodash-es.dd6a6848.js";import"./async-validator.6019f6c6.js";import"./@sxzz.69bffcbd.js";import"./escape-html.ee221422.js";import"./normalize-wheel-es.25faf228.js";import"./@ctrl.46158b0f.js";import"./vue-router.9aaff3ab.js";import"./pinia.6fe13256.js";import"./vue-demi.f95da513.js";import"./axios.44703c6e.js";/* empty css                    */import"./prismjs.5c7695b9.js";import"./vee-validate.f34e48f3.js";import"./@vee-validate.51eabfa0.js";import"./yup.b2caa524.js";import"./nanoclone.76ad5e25.js";import"./lodash.393e310d.js";import"./property-expr.8748984a.js";import"./toposort.a92fde4e.js";const te={class:""},oe=r("\u9009\u62E9\u6A21\u5757"),ue=r("\u9009\u62E9\u6A21\u5757"),se=q({__name:"selectModule",emits:["select"],async setup(s,{emit:t}){let a,y;const{load:v,modules:C}=U();[a,y]=H(()=>Promise.all([v()])),await a,y();let e=N(!1);const x=m=>{t("select",m),e.value=!1};return(m,i)=>{const k=T,B=Q,p=L;return u(),d("div",te,[_(p,{title:"\u9009\u62E9\u6A21\u5757",modelValue:o(e),"onUpdate:modelValue":i[0]||(i[0]=c=>z(e)?e.value=c:e=c),"custom-class":"dialog"},{default:l(()=>{var c;return[_(B,{data:(c=o(C))==null?void 0:c.data,columns:o(G)},{button:l(({model:$})=>[_(k,{type:"primary",size:"default",onClick:D=>x($)},{default:l(()=>[oe]),_:2},1032,["onClick"])]),_:1},8,["data","columns"])]}),_:1},8,["modelValue"]),_(k,{type:"primary",size:"default",onClick:i[1]||(i[1]=c=>z(e)?e.value=!0:e=!0)},{default:l(()=>[ue]),_:1})])}}});const ne=P(se,[["__scopeId","data-v-7824ee2d"]]);function ae(s){return F.request({url:`site/${s}/module`})}function ie(s,t){return F.request({url:`site/${s}/module`,method:"POST",data:{mid:t}})}function le(s,t){return F.request({url:`site/${s}/module/${t}`,method:"DELETE"})}function re(s,t){return F.request({url:`site/${s}/module/${t}/set_default`})}const ce=()=>{const s=N(),t=X.currentRoute.value.query.sid,a=async()=>{s.value=await ae(t)};return{modules:s,get:a,add:async e=>{await ie(t,e.id),a()},del:async e=>{try{await R.confirm("\u786E\u5B9A\u5220\u9664\u5417\uFF1F\u5220\u9664\u6A21\u5757\u5C06\u5220\u9664\u6A21\u5757\u7684\u6240\u6709\u6570\u636E\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01"),await le(t,e),a()}catch{}},setDefault:async e=>{await re(t,e),a()}}},de={key:1},_e=["src"],me={class:"py-2 bg-gray-200 border-t mt-3 w-full flex justify-center"},pe=r(" \u6A21\u5757\u540E\u53F0 "),fe=r(" \u8BBF\u95EE\u524D\u53F0 "),ye=r(" \u5220\u9664\u6A21\u5757 "),Ce=r(" \u9ED8\u8BA4\u6A21\u5757 "),ke=r(" \u9ED8\u8BA4\u6A21\u5757 "),be={key:2,class:"border p-5 rounded-sm bg-white flex justify-center items-center text-gray-600 text-xs font-bold"},ge=r(" \u4F60\u8FD8\u6CA1\u6709\u5B89\u88C5\u4EFB\u4F55\u6A21\u5757\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458 "),he=q({__name:"index",async setup(s){let t,a;const{add:y,get:v,modules:C,setDefault:e,del:x}=ce(),{currentSite:m,site:i}=Y();[t,a]=H(()=>Promise.all([m(),v(),m()])),await t,a();const k=p=>{window.open(p)},B=async p=>{await e(p),m()};return(p,c)=>{var S;const $=W,D=ne,b=T,j=O,I=ee;return u(),d(A,null,[_($,{tabs:[{label:"\u7AD9\u70B9\u5217\u8868",route:{name:"site.index"}},{label:`\u3010${(S=o(i))==null?void 0:S.title}\u3011\u7AD9\u70B9\u6A21\u5757\u8BBE\u7F6E`,route:{name:"site.module.index"}}]},null,8,["tabs"]),o(V)()?(u(),f(D,{key:0,onSelect:o(y),class:"mb-2"},null,8,["onSelect"])):h("",!0),o(C).data.length?(u(),d("section",de,[(u(!0),d(A,null,J(o(C).data,n=>(u(),d("div",{key:n.id},[w("img",{src:n.preview,class:"rounded-full h-[60px] w-[60px] object-cover my-3"},null,8,_e),w("h4",null,K(n.title),1),w("div",me,[_(j,null,{default:l(()=>{var M;return[n.admin?(u(),f(b,{key:0,type:"primary",size:"small",onClick:E=>{var g;return k(`/${n.name}/admin?sid=${(g=o(i))==null?void 0:g.id}`)}},{default:l(()=>[pe]),_:2},1032,["onClick"])):h("",!0),n.front?(u(),f(b,{key:1,type:"success",size:"small",onClick:E=>{var g;return k(`/${n.name}?sid=${(g=o(i))==null?void 0:g.id}`)}},{default:l(()=>[fe]),_:2},1032,["onClick"])):h("",!0),o(V)()?(u(),f(b,{key:2,type:"danger",size:"small",onClick:E=>o(x)(n.id)},{default:l(()=>[ye]),_:2},1032,["onClick"])):h("",!0),o(Z)("system-module-set-default",o(i))?(u(),d(A,{key:3},[n.id==((M=o(i))==null?void 0:M.module_id)?(u(),f(b,{key:0,type:"warning",size:"small",onClick:E=>B(n.id)},{default:l(()=>[Ce]),_:2},1032,["onClick"])):(u(),f(b,{key:1,type:"info",size:"small",onClick:E=>B(n.id)},{default:l(()=>[ke]),_:2},1032,["onClick"]))],64)):h("",!0)]}),_:2},1024)])]))),128))])):(u(),d("div",be,[_(I,{theme:"outline",fill:"#333",class:"mr-1"}),ge]))],64)}}});const et=P(he,[["__scopeId","data-v-ba0cb52d"]]);export{et as default};
