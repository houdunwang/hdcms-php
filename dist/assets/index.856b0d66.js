import{F as P,h as V,u as H,j as I}from"./element-plus.3904763a.js";import{m as O,_ as G}from"./table.8f1c3db2.js";import{u as R}from"./useModule.d73db515.js";import{_ as z}from"./plugin-vue_export-helper.21dcd24c.js";import{C as T,bl as N,e as j,o as s,c,b as l,H as n,u as o,A as M,O as m,G as b,M as E,Q as k,ad as K,a as F,P as Q}from"./@vue.d2db270f.js";import{_ as U}from"./tab.a2965159.js";import{h as C,r as J,g as W,d as S,f as X,a as Y}from"./index.c29e1f0e.js";import{u as Z}from"./@icon-park.3c7e9ece.js";import"./dayjs.65d36044.js";import"./@kangc.7a169bfb.js";import"./vue.49864943.js";import"./@vueuse.d99af6d0.js";import"./@element-plus.8bdeac16.js";import"./lodash-es.e24100a0.js";import"./async-validator.6019f6c6.js";import"./@sxzz.69bffcbd.js";import"./escape-html.d3a2e952.js";import"./normalize-wheel-es.25faf228.js";import"./@ctrl.46158b0f.js";import"./vue-router.cefc97b8.js";import"./pinia.16fb2893.js";import"./vue-demi.fd44cc08.js";import"./axios.af22a90f.js";import"./lodash.4b59e61b.js";import"./prismjs.e66d8193.js";import"./vee-validate.0e4c74ff.js";import"./@vee-validate.898c8da1.js";import"./yup.905b9289.js";import"./nanoclone.5d6f781b.js";import"./property-expr.8748984a.js";import"./toposort.bf2a2d8a.js";/* empty css                    */const ee={class:""},te=m("\u9009\u62E9\u6A21\u5757"),oe=m("\u9009\u62E9\u6A21\u5757"),ae=T({__name:"selectModule",emits:["select"],async setup(a,{emit:t}){let u,p;const{load:x,modules:f}=R();[u,p]=N(()=>Promise.all([x()])),await u,p();let e=j(!1);const h=v=>{t("select",v),e.value=!1};return(v,i)=>{const y=V,w=G,_=P;return s(),c("div",ee,[l(_,{title:"\u9009\u62E9\u6A21\u5757",modelValue:o(e),"onUpdate:modelValue":i[0]||(i[0]=d=>M(e)?e.value=d:e=d),"custom-class":"dialog"},{default:n(()=>{var d;return[l(w,{data:(d=o(f))==null?void 0:d.data,columns:o(O)},{button:n(({model:A})=>[l(y,{type:"primary",size:"default",onClick:$=>h(A)},{default:n(()=>[te]),_:2},1032,["onClick"])]),_:1},8,["data","columns"])]}),_:1},8,["modelValue"]),l(y,{type:"primary",size:"default",onClick:i[1]||(i[1]=d=>M(e)?e.value=!0:e=!0)},{default:n(()=>[oe]),_:1})])}}});var se=z(ae,[["__scopeId","data-v-4244a87c"]]);function ue(a){return C.request({url:`site/${a}/module`})}function ne(a,t){return C.request({url:`site/${a}/module`,method:"POST",data:{mid:t}})}function ie(a,t){return C.request({url:`site/${a}/module/${t}`,method:"DELETE"})}function re(a,t){return C.request({url:`site/${a}/module/${t}/set_default`})}var le=()=>{const a=j(),t=J.currentRoute.value.params.sid,u=async()=>{a.value=await ue(t)};return{modules:a,get:u,add:async e=>{await ne(t,e.id),u()},del:async e=>{try{await H.confirm("\u786E\u5B9A\u5220\u9664\u5417\uFF1F\u5220\u9664\u6A21\u5757\u5C06\u5220\u9664\u6A21\u5757\u7684\u6240\u6709\u6570\u636E\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01"),await ie(t,e),u()}catch{}},setDefault:async e=>{await re(t,e),u()}}};const de={key:1},ce=["src"],me={class:"py-2 bg-gray-200 border-t mt-3 w-full flex justify-center"},_e=m("\u8FDB\u5165\u6A21\u5757"),pe=m(" \u5220\u9664\u6A21\u5757 "),fe=m(" \u53D6\u6D88\u9ED8\u8BA4\u6A21\u5757 "),ve=m(" \u8BBE\u4E3A\u9ED8\u8BA4\u6A21\u5757 "),xe={key:2,class:"border p-5 rounded-sm bg-white flex justify-center items-center text-gray-600 text-xs font-bold"},he=m(" \u4F60\u8FD8\u6CA1\u6709\u5B89\u88C5\u4EFB\u4F55\u6A21\u5757\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458 "),ye=T({__name:"index",async setup(a){let t,u;const{add:p,get:x,modules:f,setDefault:e,del:h}=le(),{currentSite:v,site:i}=W();[t,u]=N(()=>Promise.all([v(),x()])),await t,u();const y=_=>{window.open(Y.VITE_MOCK_ENABLE?"/admin":`/${_.name}/admin`)},w=async _=>{await e(_),v()};return(_,d)=>{const A=U,$=se,g=V,q=I,L=Z;return s(),c(k,null,[l(A,{tabs:[{label:"\u7AD9\u70B9\u5217\u8868",route:{name:"site.index"}},{label:`\u3010${o(i)}\u3011\u7AD9\u70B9\u6A21\u5757\u8BBE\u7F6E`,route:{name:"site.module.index"}}]},null,8,["tabs"]),o(S)()?(s(),b($,{key:0,onSelect:o(p),class:"mb-2"},null,8,["onSelect"])):E("",!0),o(f).data.length?(s(),c("section",de,[(s(!0),c(k,null,K(o(f).data,r=>(s(),c("div",{key:r.id},[F("img",{src:r.preview,class:"rounded-full h-[60px] w-[60px] object-cover my-3"},null,8,ce),F("h4",null,Q(r.title),1),F("div",me,[l(q,null,{default:n(()=>{var D;return[l(g,{type:"primary",size:"small",onClick:B=>y(r)},{default:n(()=>[_e]),_:2},1032,["onClick"]),o(S)()?(s(),b(g,{key:0,type:"danger",size:"small",onClick:B=>o(h)(r.id)},{default:n(()=>[pe]),_:2},1032,["onClick"])):E("",!0),o(X)("system-module-set-default",o(i))?(s(),c(k,{key:1},[r.id==((D=o(i))==null?void 0:D.module_id)?(s(),b(g,{key:0,type:"success",size:"small",onClick:B=>w(r.id)},{default:n(()=>[fe]),_:2},1032,["onClick"])):(s(),b(g,{key:1,type:"info",size:"small",onClick:B=>w(r.id)},{default:n(()=>[ve]),_:2},1032,["onClick"]))],64)):E("",!0)]}),_:2},1024)])]))),128))])):(s(),c("div",xe,[l(L,{theme:"outline",fill:"#333",class:"mr-1"}),he]))],64)}}});var Ye=z(ye,[["__scopeId","data-v-64b45ce0"]]);export{Ye as default};
