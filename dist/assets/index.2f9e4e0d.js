import{H as G,h as T,y as I,o as O}from"./element-plus.da21f900.js";import{m as R,_ as Q}from"./table.c8ddd116.js";import{u as U}from"./useModule.101777e6.js";import{_ as q}from"./plugin-vue_export-helper.21dcd24c.js";import{C as H,bl as N,d as P,o as a,c,b as m,H as r,u as o,A as z,O as l,G as f,M as g,Q as $,ad as J,a as A,P as K}from"./@vue.ac3c99c7.js";import{_ as W}from"./tab.2e01d733.js";import{h as E,r as X,g as Y,d as V,f as Z}from"./index.9fddb2f0.js";import{u as ee}from"./@icon-park.f131a0de.js";import"./dayjs.0c888375.js";import"./@kangc.1996ede0.js";import"./vue.3a73d106.js";import"./@vueuse.bdb320bd.js";import"./@element-plus.9265bdf6.js";import"./lodash-es.e24100a0.js";import"./async-validator.6019f6c6.js";import"./@sxzz.69bffcbd.js";import"./escape-html.d3a2e952.js";import"./normalize-wheel-es.25faf228.js";import"./@ctrl.46158b0f.js";import"./vue-router.ee40a60b.js";import"./pinia.3af4ac7f.js";import"./vue-demi.fd44cc08.js";import"./axios.af22a90f.js";import"./lodash.2484672c.js";import"./prismjs.80502f0c.js";import"./vee-validate.c3c37b64.js";import"./@vee-validate.898c8da1.js";import"./yup.bddae821.js";import"./nanoclone.5d6f781b.js";import"./property-expr.8748984a.js";import"./toposort.bf2a2d8a.js";/* empty css                    */const te={class:""},oe=l("\u9009\u62E9\u6A21\u5757"),ae=l("\u9009\u62E9\u6A21\u5757"),se=H({__name:"selectModule",emits:["select"],async setup(s,{emit:t}){let i,v;const{load:C,modules:x}=U();[i,v]=N(()=>Promise.all([C()])),await i,v();let e=P(!1);const b=_=>{t("select",_),e.value=!1};return(_,n)=>{const y=T,k=Q,p=G;return a(),c("div",te,[m(p,{title:"\u9009\u62E9\u6A21\u5757",modelValue:o(e),"onUpdate:modelValue":n[0]||(n[0]=d=>z(e)?e.value=d:e=d),"custom-class":"dialog"},{default:r(()=>{var d;return[m(k,{data:(d=o(x))==null?void 0:d.data,columns:o(R)},{button:r(({model:F})=>[m(y,{type:"primary",size:"default",onClick:D=>b(F)},{default:r(()=>[oe]),_:2},1032,["onClick"])]),_:1},8,["data","columns"])]}),_:1},8,["modelValue"]),m(y,{type:"primary",size:"default",onClick:n[1]||(n[1]=d=>z(e)?e.value=!0:e=!0)},{default:r(()=>[ae]),_:1})])}}});var ue=q(se,[["__scopeId","data-v-33c37e92"]]);function ie(s){return E.request({url:`site/${s}/module`})}function ne(s,t){return E.request({url:`site/${s}/module`,method:"POST",data:{mid:t}})}function re(s,t){return E.request({url:`site/${s}/module/${t}`,method:"DELETE"})}function le(s,t){return E.request({url:`site/${s}/module/${t}/set_default`})}var de=()=>{const s=P(),t=X.currentRoute.value.query.sid,i=async()=>{s.value=await ie(t)};return{modules:s,get:i,add:async e=>{await ne(t,e.id),i()},del:async e=>{try{await I.confirm("\u786E\u5B9A\u5220\u9664\u5417\uFF1F\u5220\u9664\u6A21\u5757\u5C06\u5220\u9664\u6A21\u5757\u7684\u6240\u6709\u6570\u636E\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01"),await re(t,e),i()}catch{}},setDefault:async e=>{await le(t,e),i()}}};const ce={key:1},me=["src"],_e={class:"py-2 bg-gray-200 border-t mt-3 w-full flex justify-center"},pe=l(" \u6A21\u5757\u540E\u53F0 "),fe=l(" \u8BBF\u95EE\u524D\u53F0 "),ve=l(" \u5220\u9664\u6A21\u5757 "),xe=l(" \u9ED8\u8BA4\u6A21\u5757 "),ye=l(" \u9ED8\u8BA4\u6A21\u5757 "),he={key:2,class:"border p-5 rounded-sm bg-white flex justify-center items-center text-gray-600 text-xs font-bold"},we=l(" \u4F60\u8FD8\u6CA1\u6709\u5B89\u88C5\u4EFB\u4F55\u6A21\u5757\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458 "),ge=H({__name:"index",async setup(s){let t,i;const{add:v,get:C,modules:x,setDefault:e,del:b}=de(),{currentSite:_,site:n}=Y();[t,i]=N(()=>Promise.all([_(),C(),_()])),await t,i();const y=p=>{window.open(p)},k=async p=>{await e(p),_()};return(p,d)=>{var M;const F=W,D=ue,h=T,j=O,L=ee;return a(),c($,null,[m(F,{tabs:[{label:"\u7AD9\u70B9\u5217\u8868",route:{name:"site.index"}},{label:`\u3010${(M=o(n))==null?void 0:M.title}\u3011\u7AD9\u70B9\u6A21\u5757\u8BBE\u7F6E`,route:{name:"site.module.index"}}]},null,8,["tabs"]),o(V)()?(a(),f(D,{key:0,onSelect:o(v),class:"mb-2"},null,8,["onSelect"])):g("",!0),o(x).data.length?(a(),c("section",ce,[(a(!0),c($,null,J(o(x).data,u=>(a(),c("div",{key:u.id},[A("img",{src:u.preview,class:"rounded-full h-[60px] w-[60px] object-cover my-3"},null,8,me),A("h4",null,K(u.title),1),A("div",_e,[m(j,null,{default:r(()=>{var S;return[u.admin?(a(),f(h,{key:0,type:"primary",size:"small",onClick:B=>{var w;return y(`/${u.name}/admin?sid=${(w=o(n))==null?void 0:w.id}`)}},{default:r(()=>[pe]),_:2},1032,["onClick"])):g("",!0),u.front?(a(),f(h,{key:1,type:"success",size:"small",onClick:B=>{var w;return y(`/${u.name}?sid=${(w=o(n))==null?void 0:w.id}`)}},{default:r(()=>[fe]),_:2},1032,["onClick"])):g("",!0),o(V)()?(a(),f(h,{key:2,type:"danger",size:"small",onClick:B=>o(b)(u.id)},{default:r(()=>[ve]),_:2},1032,["onClick"])):g("",!0),o(Z)("system-module-set-default",o(n))?(a(),c($,{key:3},[u.id==((S=o(n))==null?void 0:S.module_id)?(a(),f(h,{key:0,type:"warning",size:"small",onClick:B=>k(u.id)},{default:r(()=>[xe]),_:2},1032,["onClick"])):(a(),f(h,{key:1,type:"info",size:"small",onClick:B=>k(u.id)},{default:r(()=>[ye]),_:2},1032,["onClick"]))],64)):g("",!0)]}),_:2},1024)])]))),128))])):(a(),c("div",he,[m(L,{theme:"outline",fill:"#333",class:"mr-1"}),we]))],64)}}});var et=q(ge,[["__scopeId","data-v-06a294e1"]]);export{et as default};
